<!DOCTYPE html>
<html>
<head>
  <title>Financial days Tracker</title>
  <style> 
td.date {
  text-align: left;
  white-space: nowrap;
}    
form {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  width: 300px;
  margin: 0 auto;
  padding: 20px;
  background-color: #fafafa;
  border: 1px solid #dddddd;
  border-radius: 4px;
}

form label {
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 8px;
}

form input, form select {
  width: 100%;
  height: 32px;
  padding: 0 8px;
  margin-bottom: 16px;
  border: 1px solid #dddddd;
  border-radius: 4px;
  font-size: 14px;
}

form button[type="submit"] {
  width: 100%;
  height: 32px;
  background-color: #0000ff;
  color: #ffffff;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
}

form button[type="submit"]:hover {
  background-color: #0000cc;
}

table {
  width: 100%;
  margin: 20px 0;
  border-collapse: collapse;
  font-family: Arial, sans-serif;
  color: #333333;
}

th {
  background-color: #f0f0f0;
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
  font-size: 14px;
  font-weight: bold;
}

td {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
  font-size: 14px;
}

tr:nth-child(even) {
  background-color: #f2f2f2;
}

.amount {
  text-align: right;
}

 
  </style>
</head>
<body>
  <h1>Solde journalier Tracker</h1>
 <!-- Use a form to capture input from the user -->
<form id="date-filter-form">
  <label for="start-date">Start Date:</label><br>
  <input type="date" id="start-date"><br>
  <label for="end-date">End Date:</label><br>
  <input type="date" id="end-date"><br><br>
  <label for="date-grouping">Group by:</label><br>
  <select id="date-grouping">
    <option value="day">Jour</option>
    <option value="month">Mois</option>
    <option value="year">Ann√©e</option>
  </select><br><br>
  <button type="button" onclick="filterTransactions()">Filter Transactions</button>
</form> 

<!-- Display the transaction history -->
<h2>Transaction History</h2>
<table id="transaction-history">
  <tr>
    <th>Date</th>
    <th>Input</th>
    <th>Output</th>
    <th>Balance</th>
  </tr>
</table>


<script>
  // Get a reference to the form and input fields
  const form = document.querySelector('#date-filter-form');
  const startDateField = document.querySelector('#start-date');
  const endDateField = document.querySelector('#end-date');
  const dateGroupingField = document.querySelector('#date-grouping');

  // Get a reference to the transaction history table
  const historyTable = document.querySelector('#transaction-history');

  // Set up an event listener for the form submission
  form.addEventListener('submit', e => {
    // Prevent the default form submission behavior
    e.preventDefault();

    // Get the start and end dates from the form fields
    const startDate = startDateField.value;
    const endDate = endDateField.value;
    const dateGrouping = dateGroupingField.value;

    // Clear the table
    historyTable.innerHTML = '';

    // Add the table headers
    historyTable.innerHTML = `
    <tr>
      <th>Date</th>
      <th>Input</th>
      <th>Output</th>
      <th>Balance</th>
    </tr>
  `;

    // Retrieve the transactions from local storage
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

    // Filter the transactions by the selected start and end dates
    let filteredTransactions = transactions.filter(transaction => {
      const transactionDate = new Date(transaction.date);
      const start = new Date(startDate);
      const end = new Date(endDate);
      return transactionDate >= start && transactionDate <= end;
    });

    // Group the transactions by the selected option
    let groupedTransactions = {};
    if (dateGrouping === 'day') {
      filteredTransactions.forEach(transaction => {
        const transactionDate = new Date(transaction.date).toISOString().substring(0, 10);
        if (groupedTransactions[transactionDate]) {
          groupedTransactions[transactionDate].push(transaction);
        } else {
          groupedTransactions[transactionDate] = [transaction];
        }
      });
    } else if (dateGrouping === 'month') {
      filteredTransactions.forEach(transaction => {
        const transactionDate = new Date(transaction.date).toISOString().substring(0, 7);
        if (groupedTransactions[transactionDate]) {
          groupedTransactions[transactionDate].push(transaction);
        } else {
          groupedTransactions[transactionDate] = [transaction];
        }
      });
    } else if (dateGrouping === 'year') {
      filteredTransactions.forEach(transaction => {
        const transactionDate = new Date(transaction.date).toISOString().substring(0, 4);
        if (groupedTransactions[transactionDate]) {
          groupedTransactions[transactionDate].push(transaction);
        } else {
          groupedTransactions[transactionDate] = [transaction];
        }
      });
    }
  
  
// Set the initial balance to 0
let balance = 0;

// Iterate over the grouped transactions and add rows to the table for each group of transactions
for (const date in groupedTransactions) {
// Calculate the input, output, and balance for the group of transactions
let input = 0;
let output = 0;
groupedTransactions[date].forEach(transaction => {
if (transaction.type === 'credit') {
balance += Number(transaction.amount);
input += Number(transaction.amount);
} else {
balance -= Number(transaction.amount);
output += Number(transaction.amount);
}
});
// Add a new row to the table with the date, input, output, and balance for the group of transactions
const dateFormatted = new Date(date).toLocaleDateString();
historyTable.innerHTML += <tr> <td class="date">${dateFormatted}</td> <td class="amount">${input.toFixed(2)}</td> <td class="amount">${output.toFixed(2)}</td> <td class="amount">${balance.toFixed(2)}</td> </tr>;
}
});
</script>

</body>
</html>
